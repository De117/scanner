# scanner

This is a small, modular scanner, done in Python 3.

*skeleton.py* is the main script; it checks the *modules/* directory for any .py files with names other than "test\*", 
loads them as modules, and runs them for each input record. The input file consists of one hostname or IPv4 address per line; 
the main script looks up the missing part. If the hostname cannot be found by reverse DNS lookup, it is set to "?" instead. 

### Modules
Its modules are python modules; their only point of contact with the main script is by a *process(host, stream)* function, 
where host is a *(hostname, IP\_address)* tuple and stream is a file object to which the module is supposed to write its output.

There are currently two such modules included:
 - *sslmodule*
  * checks supported SSL/TLS versions on port 443
  * if the appropriate flag (DETECT_CIPHERS) is set, it also detects the supported cipher suites for each protocol version
  * it is limited, however, to those protocols and ciphers provided in the Python ssl module
 - *wpmodule*
  * checks whether the webpages are generated by WordPress, which version, and which WordPress plugins the site uses
  * works by checking the "generator" tags (in case of WordPress versions) and the "/wp-content/plugins/pluginname" HTTP response (in case of plugins)
  * for now, no advanced heuristics.
  
### How to use
A short list of domain names is included (*example_wp_list*). Run as
```bash
./skeleton.py example_wp_list
```
It should output results from both plugins to stdout. 
The default list is *wp_plugins.txt* in the *modules/* directory, of 10 plugins. The full list of plugins is *wp_plugins_long.txt*, of over 16000 plugins. 
